# Kubernetes Basis
* [Why Kubernetes?](#Why-Kubernetes?)  
* [VM vs Container](#VM-vs-Container)

# Why kubernetes?
<img src="https://user-images.githubusercontent.com/50009240/137632762-a0698789-02ba-4b81-b33e-dd674c4e0ca1.png" width="750" height="350"> 

* 서비스 운영
 방식
  * 한 회사에서 3개의 서비스를 운영하고 있을 때, 오전에는 A서비스, 오후에는 B서비스, 밤에는 C서비스의 접속량이 많아진다고 가정한다. 각 서비스는 3개의 서버 할당 필요
  * 기존 시스템
    * A서비스는 다른 시간대에 트래픽이 적더라도 오전 시간의 서비스 운영을 위해 3개의 서버가 할당되어야 됨. B,C도 마찬가지로 각각 3개의 서버가 필요하므로 총 9대의 서버가 필요.
  * 쿠버네티스
    * `Auto Scaling` 기능을 통해 트래픽의 양에 따라서 서비스의 자원량을 변경시켜줌.
    * 따라서 3개의 서비스 평균 트래픽에 해당하는 4개의 서버 자원만 할당해 사용
* 서버에 장애가 발생한 경우
  * 기존 시스템
    * 서버 장애 상황에 대비해 한 대의 여분 서버가 필요, 총 3대의 여분 서버 필요
    * 각 서비스 별로 백업 서버를 두어서 운영 중인 서버가 죽었을 때 즉각적인 대응을 할 수 있음.
  * 쿠버네티스
    * `Auto Healing` 기능을 통해 장애가 난 서버 위에 있는 서비스들을 다른 서버로 자동 옮겨줌
    * 따라서 한 서버에 장애가 나더라도, 여분의 서버 한 대만 있으면 알아서 서비스를 유지시켜줌.
* 서비스의 버전 업데이트 경우
  * 기존 시스템
    * 서버의 중단이 허용되는 경우 모든 서버를 내렸다가 업데이트 작업 후에 다시 올림.
    * 무중단 서비스를 해야되는 경우 한 서버씩 내렸다가 업데이트 작업 후에 서비스를 올리는 방식으로 진행
  * 쿠버네티스
    * `Deployment` 오브젝트를 통해 업데이트 방식에 대해 자동적으로 처리되도록 지원
* 쿠버네티스는 여러 자동화 기능을 지원해 운영 환경이 편리해지고, 서비스 효율이 증가함.
* 서비스 효율로 인해 서버를 줄이면 유지보수 비용 감소

# VM vs Container
<img src="https://user-images.githubusercontent.com/50009240/137634275-07d5f165-ddba-478f-8475-51e9e7c34c42.png" width="700" height="350"> 

* VM
  * `Host OS` 위에 VM을 가상화 시켜주기 위해 여러 `Hypervisor`가 있음
  * Hypervisor를 사용해 원하는 운영체제로 `Guest OS`를 올려서 VM 생성
  * Guest OS도 Host OS와 같이 하나의 독립적인 OS를 가진 것처럼 사용 가능
  * Guest OS로 Host OS와 다른 운영체제 사용 가능
  * 보안적으로 Guest OS가 뚫려도 Guest OS와 Host OS가 완벽히 분리되어 있기 때문에 다른 os에 피해 없음
* Container
  * 프로세스 단위의 격리된 환경을 만들어 사용
  * Host OS위에 컨테이너 가상화 소프트웨어(docker...)를 이용해 컨테이너 생성
  * Host OS와 같은 운영체제의 컨테이너만 사용 가능
  * 보안적으로 한 컨테이너가 뚫리면 다른 컨테이너도 피해 받을 수 있음
  * 모듈 별로 쪼개 컨테이너에 담고, 필요한 `컨테이너/Pod`단위로 확장 가능
  * 쿠버네티스에서는 여러 컨테이너들을 `Pod`로 묶을 수 있음, `Pod`는 하나의 배포 단위
* Docker
  * 여러 컨테이너들 간에 호스트 자원을 분리해서 쓰도록 해줌
  * os에서 제공하는 자원격리 기술을 이용해 `컨테이너`단위로 서비스를 분리
    * `namespace`로 커널에 관련된 영역을 분리하고, `cgroups`로 자원에 대한 영역을 분리
  * 컨테이너 가상화가 설치되어 있는 os에서는 개발환경에 대한 걱정 없이 배포 가능



















